@inherits Umbraco.Web.Mvc.UmbracoTemplatePage<ContentModels.Research>
@using ContentModels = Umbraco.Web.PublishedContentModels;
@{
	Layout = "umbLayout.cshtml";
	var selection = CurrentPage.Descendants("researchProject").Where("Visible && endDate.Year == 1").OrderBy("Name");
	var categories = CurrentPage.Descendants("researchProjectCategory")
		.Where("Visible").OrderBy("Name");
}

<div class="container">		
@* Title *@
	@{ Html.RenderPartial("breadcrumb"); }
	<div class="page-header">
		<h1>Our Research <small>Active Research Projects</small></h1>
	</div>

<div class="row">
	<div class="col-md-3">
		<div class="panel panel-default">
  <div class="panel-heading">Research Category</div>
  <ul class="list-group">
	  @foreach (var cat in categories) {
		      <li class="list-group-item"><a href="@cat.Url">@cat.Title</a></li>
	  }
  </ul>
</div>
</div>
		
	<div class="col-md-9">
		@* Projects *@
@foreach (var item in selection) {
	var methods = item.GetPropertyValue("methods").Split(',');
	var topics = item.GetPropertyValue("topics").Split(',');
	
		<div class="project-list-item">
			<img src="@item.GetCropUrl("image", "thumbnail")" />
			<div class="summary">
				<h3><a href="@item.Url">@item.GetPropertyValue("projectTitle")</a></h3>
				<p>@Umbraco.Truncate(item.GetPropertyValue("description"), 200)</p>
												<div class="tags">
					<span>
					@foreach (var tag in methods) {
						<span class="tag">@tag</span>
					}</span>
					<span>
					@foreach (var tag in topics) {
						<span class="tag">@tag</span>
					}</span>
				</div>
			</div>
		</div>
}

	</div>
</div>
		
</div>
	</div>